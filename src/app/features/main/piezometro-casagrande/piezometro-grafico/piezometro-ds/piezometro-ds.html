<h3 class="text-3xl font-bold p-4 ">Piezómetro</h3>

<div class="card flex justify-end pb-2">
    @if (showClearButton) {
        <p-button 
            label="Limpiar" 
            class="mr-2" 
            (onClick)="clearCharts()"
            severity="secondary"
        />
    }
    <p-button 
        label="Gráficar" 
        class="mr-4" 
        (onClick)="generateCharts()"
        [disabled]="!selectedPiezometro || selectedPiezometro.length === 0"
    />
    <p-multiselect 
        [options]="piezometro" 
        [(ngModel)]="selectedPiezometro" 
        optionLabel="nombrePiezometro" 
        placeholder="Seleccione Piezómetros" 
        display="chip" 
        class="w-full md:w-80" 
        (onChange)="onPiezometroChange()"
    />
</div>

<!-- Filtros de fecha -->
@if (showDateFilters) {
    <div class="card flex flex-wrap gap-6 items-end justify-start p-6 bg-gray-50 border-l-4 border-blue-500">
        <div class="flex flex-col">
            <label class="text-sm font-semibold text-gray-700 mb-2">Fecha Inicio:</label>
            <p-datepicker 
                [(ngModel)]="startDate" 
                (onSelect)="onStartDateChange()"
                [showIcon]="true"
                placeholder="Seleccionar fecha"
                dateFormat="dd/mm/yy"
                class="w-48"
                [style]="{'min-width': '180px'}"
            />
        </div>
        
        <div class="flex flex-col">
            <label class="text-sm font-semibold text-gray-700 mb-2">Fecha Fin:</label>
            <p-datepicker 
                [(ngModel)]="endDate" 
                (onSelect)="onEndDateChange()"
                [showIcon]="true"
                placeholder="Seleccionar fecha"
                dateFormat="dd/mm/yy"
                class="w-48"
                [style]="{'min-width': '180px'}"
            />
        </div>
        
        <div class="flex flex-col ml-4">
            <p-button 
                label="Limpiar Filtro" 
                (onClick)="clearDateFilter()"
                severity="secondary"
                [outlined]="true"
                size="small"
                icon="pi pi-times"
                class="h-10"
            />
        </div>
    </div>
}

<div class="space-y-6 w-[70vw] py-6">
    <!-- Render a chart for each piezometro -->
    @for (chart of dataEsteNorte; track chart.nombreHito) {
        <div class="card bg-white border rounded-border" id="chartEsteNorte">
            <p-chart type="line" [data]="chart.data" [options]="chart.options" class="h-[30rem]" />
        </div>
    } @empty {
        <div class="flex justify-center items-center h-[30rem]">
            <div class="text-black text-lg">No hay datos disponibles.</div>
        </div>
    }
</div>

@if(showClearButton) {
    <div class="card flex justify-end pb-4">
        <p-button 
            label="Descargar" 
            class="mr-2" 
            (onClick)="downloadCharts()"
            severity="success"
            icon="pi pi-download"
        />
    </div>
}